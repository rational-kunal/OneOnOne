{"version":3,"sources":["../node_modules/peerjs/dist sync","components/Home.js","appDispatcher.js","actions/types.js","stores/chatStore.js","components/Chat/DumbComponets.js","components/Chat/index.js","components/Video.js","components/Room/DumbComponents.js","components/Room/index.js","actions/chatActions.js","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","Home","useState","joinId","setJoinId","style","margin","to","Button","variant","TextField","marginRight","size","label","value","onChange","target","dispatcher","Dispatcher","_blabHistory","chatStore","callback","this","on","removeListener","emit","EventEmitter","register","action","actionType","actionTypes","push","blab","emitChange","SendBlabView","sendToFn","blabValue","setBlabValue","component","InputBase","marginLeft","placeholder","IconButton","type","aria-label","onClick","BlabView","ListItem","button","ListItemIcon","by","ListItemText","primary","Divider","light","Chat","blabHistory","setBlabHistory","sendFn","useContext","ChatContext","useEffect","addChangeListener","getBlabHistory","Paper","map","Video","stream","React","createRef","videoRef","current","srcObject","Card","marginBottom","raised","width","height","ref","autoPlay","RoomView","localStream","otherPeerStream","shoulDisplayChat","joinData","Grid","container","spacing","item","xs","md","shouldShow","JoinTo","peerId","Typography","padding","CircularProgress","createContext","Room","otherPeerId","useParams","Peer","host","secure","port","peer","setPeerId","otherPeerConnection","setOtherPeerConnection","setLocalStream","call","setCall","setOtherPeerStream","console","info","connection","connect","navigator","mediaDevices","getUserMedia","audio","video","then","catch","error","data","dispatch","answer","Provider","send","chatActions","undefined","App","path","AppContainer","theme","createMuiTheme","palette","ThemeProvider","CssBaseline","Container","marginTop","maxWidth","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.406abd30.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 87;","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\n\nexport default function Home() {\n  const [joinId, setJoinId] = useState('');\n  return (\n    <div>\n      <div style={{ margin: '12px' }}>\n        <Link to=\"/create\">\n          <Button variant=\"contained\">create room</Button>\n        </Link>\n      </div>\n      <div style={{ margin: '12px' }}>\n        <TextField\n          style={{ marginRight: '12px' }}\n          size=\"small\"\n          label=\"peer id\"\n          variant=\"outlined\"\n          value={joinId}\n          onChange={(e) => setJoinId(e.target.value)}\n        />\n        <Link to={'/join/' + joinId}>\n          <Button variant=\"contained\" size=\"large\">\n            join\n          </Button>\n        </Link>\n      </div>\n    </div>\n  );\n}\n","import { Dispatcher } from 'flux';\n\nconst dispatcher = new Dispatcher();\n\nexport default dispatcher;\n","export default {\n  BLAB_RECEVIE: 'BLAB_RECEVIE',\n  BLAB_SEND: 'BLAB_SEND',\n};\n","import { EventEmitter } from 'events';\nimport dispatcher from '../appDispatcher';\nimport actionTypes from '../actions/types';\n\nconst CHANGE_EVENT = 'change';\nlet _blabHistory = [];\n\nclass ChatStore extends EventEmitter {\n  addChangeListener(callback) {\n    this.on(CHANGE_EVENT, callback);\n  }\n\n  removeChangeListner(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n\n  emitChange() {\n    this.emit(CHANGE_EVENT);\n  }\n\n  getBlabHistory() {\n    return _blabHistory;\n  }\n}\n\nconst chatStore = new ChatStore();\n\ndispatcher.register((action) => {\n  switch (action.actionType) {\n    case actionTypes.BLAB_RECEVIE:\n      _blabHistory.push(action.blab);\n      chatStore.emitChange();\n      break;\n    case actionTypes.BLAB_SEND:\n      _blabHistory.push(action.blab);\n      chatStore.emitChange();\n      break;\n    default:\n      break;\n  }\n});\n\nexport default chatStore;\n","import React, { useState } from 'react';\n\nimport InputBase from '@material-ui/core/InputBase';\nimport Divider from '@material-ui/core/Divider';\nimport IconButton from '@material-ui/core/IconButton';\nimport SendIcon from '@material-ui/icons/Send';\nimport BlabSendIcon from '@material-ui/icons/CallMade';\nimport BlabRecievedIcon from '@material-ui/icons/CallReceived';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\n\nexport function SendBlabView({ sendToFn }) {\n  const [blabValue, setBlabValue] = useState('');\n  return (\n    <div component=\"form\">\n      <InputBase\n        style={{ marginLeft: 12 }}\n        value={blabValue}\n        onChange={(e) => setBlabValue(e.target.value)}\n        placeholder=\"Chat\"\n      />\n      <IconButton\n        type=\"submit\"\n        aria-label=\"search\"\n        onClick={() => sendToFn(blabValue)}\n      >\n        <SendIcon />\n      </IconButton>\n    </div>\n  );\n}\n\nexport function BlabView({ blab }) {\n  return (\n    <>\n      <ListItem button>\n        <ListItemIcon>\n          {blab.by === 'me' ? <BlabSendIcon /> : <BlabRecievedIcon />}\n        </ListItemIcon>\n        <ListItemText primary={blab.blab} />\n      </ListItem>\n      <Divider light />\n    </>\n  );\n}\n","import React, { useEffect, useState, useContext } from 'react';\nimport chatStore from '../../stores/chatStore';\nimport { ChatContext } from '../Room';\n\nimport Paper from '@material-ui/core/Paper';\n\nimport { BlabView, SendBlabView } from './DumbComponets';\n\nexport default function Chat() {\n  const [blabHistory, setBlabHistory] = useState([]);\n  const sendFn = useContext(ChatContext);\n\n  useEffect(() => {\n    chatStore.addChangeListener(() => {\n      setBlabHistory([...chatStore.getBlabHistory()]);\n    });\n  }, []);\n\n  return (\n    <Paper>\n      {blabHistory.map((blab) => (\n        <BlabView blab={blab} />\n      ))}\n\n      <SendBlabView sendToFn={sendFn} />\n    </Paper>\n  );\n}\n","import React, { useState } from 'react';\n\nimport Card from '@material-ui/core/Card';\n\nexport default function Video({ stream }) {\n  const [videoRef] = useState(React.createRef());\n  if (stream) {\n    videoRef.current.srcObject = stream;\n  }\n\n  return (\n    <Card style={{ marginBottom: 12 }} variant=\"outlined\" raised={true}>\n      <video width=\"100%\" height=\"100%\" ref={videoRef} autoPlay></video>\n    </Card>\n  );\n}\n","import React from 'react';\nimport Chat from '../Chat';\nimport Video from '../Video';\n\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nexport function RoomView({\n  localStream,\n  otherPeerStream,\n  shoulDisplayChat,\n  joinData,\n}) {\n  return (\n    <Grid container spacing={2}>\n      <Grid item xs={12} md={5}>\n        <Video stream={localStream} />\n        <Video stream={otherPeerStream} />\n      </Grid>\n      <Grid item xs={12} md={7}>\n        {joinData.shouldShow && <JoinTo peerId={joinData.peerId} />}\n        {shoulDisplayChat && <Chat />}\n      </Grid>\n    </Grid>\n  );\n}\n\nfunction JoinTo({ peerId }) {\n  return (\n    <Paper style={{ marginBottom: 12 }}>\n      <Typography variant=\"h6\" style={{ padding: 12 }}>\n        {peerId ? 'peer id https://rational-kunal.github.io/OneOnOne/join/' + peerId : <CircularProgress />}\n      </Typography>\n    </Paper>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport Peer from 'peerjs';\n\nimport * as chatActions from '../../actions/chatActions';\n\nimport { RoomView } from './DumbComponents';\n\nexport const ChatContext = React.createContext();\n\nexport default function Room() {\n  const { otherPeerId } = useParams();\n\n  // todo host peer server\n  const [peer] = useState(\n    new Peer({ host: 'peerjs-server.herokuapp.com', secure: true, port: 443 })\n  );\n  const [peerId, setPeerId] = useState(null);\n  const [otherPeerConnection, setOtherPeerConnection] = useState(null);\n  const [localStream, setLocalStream] = useState(null);\n  const [call, setCall] = useState(null);\n  const [otherPeerStream, setOtherPeerStream] = useState(null);\n\n  useEffect(() => {\n    peer.on('open', (id) => {\n      console.info('connection id', id);\n      if (otherPeerId) {\n        const connection = peer.connect(otherPeerId);\n        console.info('send connection to', otherPeerId);\n        setOtherPeerConnection(connection);\n      } else {\n        setPeerId(id);\n        peer.on('connection', function (connection) {\n          console.info('connection arrived from', connection);\n          setOtherPeerConnection(connection);\n        });\n      }\n    });\n\n    peer.on('call', (call) => {\n      console.info('call arrived', call);\n      setCall(call);\n    });\n  }, []);\n\n  useEffect(() => {\n    navigator.mediaDevices\n      .getUserMedia({ audio: true, video: true })\n      .then((stream) => {\n        setLocalStream(stream);\n      })\n      .catch((error) => console.error(error));\n  }, []);\n\n  useEffect(() => {\n    otherPeerConnection &&\n      otherPeerConnection.on('open', () => {\n        console.info('connection opened');\n        otherPeerConnection.on('data', (data) => {\n          chatActions.recieveBlab(data);\n        });\n      });\n  }, [otherPeerConnection]);\n\n  // todo: remove this block\n  if (call) {\n    if (!otherPeerStream) call.answer(localStream);\n    call.on('stream', (stream) => setOtherPeerStream(stream));\n  } else {\n    if (localStream && otherPeerConnection) {\n      console.info('calling to', otherPeerId);\n      setCall(peer.call(otherPeerId, localStream));\n    }\n  }\n\n  function sendBlab(blab) {\n    otherPeerConnection.send(blab);\n    chatActions.sendBlab(blab);\n  }\n\n  return (\n    <ChatContext.Provider value={sendBlab}>\n      <RoomView\n        localStream={localStream}\n        otherPeerStream={otherPeerStream}\n        shoulDisplayChat={otherPeerStream !== null}\n        joinData={{\n          peerId,\n          shouldShow: otherPeerId === undefined && !otherPeerConnection,\n        }}\n      />\n    </ChatContext.Provider>\n  );\n}\n","import dispatcher from '../appDispatcher';\nimport actionTypes from './types';\n\nexport function recieveBlab(blab) {\n  dispatcher.dispatch({\n    actionType: actionTypes.BLAB_RECEVIE,\n    blab: { blab, by: 'notme' },\n  });\n}\n\nexport function sendBlab(blab) {\n  dispatcher.dispatch({\n    actionType: actionTypes.BLAB_SEND,\n    blab: { blab, by: 'me' },\n  });\n}\n","import React from 'react';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\nimport Home from './components/Home';\nimport Room from './components/Room';\n\nimport { ThemeProvider, createMuiTheme } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Container from '@material-ui/core/Container';\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/join/:otherPeerId\">\n          <Room />\n        </Route>\n        <Route path=\"/create\">\n          <Room />\n        </Route>\n        <Route path=\"/\">\n          <Home />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nfunction AppContainer() {\n  const theme = createMuiTheme({\n    palette: { type: 'dark' },\n  });\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <Container style={{ marginTop: 24, marginBottom: 24 }} maxWidth=\"md\">\n        <App />\n      </Container>\n    </ThemeProvider>\n  );\n}\n\nexport default AppContainer;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}